<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ranking BG España | La Taberna</title>

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Metamorphic:wght@400;700&family=MedievalSharp&family=Lato:wght@300;400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="particles" id="particles"></div>

    <main class="content-wrapper">
        <header>
            <div class="header-banner"></div>
            <!-- Nav injected by JS -->
            <nav id="main-nav" class="main-nav"></nav>
        </header>

        <div class="season-label">TEMPORADA</div>
        <nav class="season-nav" id="season-selector"></nav>

        <section class="podium" id="podium-top" style="display: none;">
            <!-- Dinámico -->
        </section>

        <div class="search-container">
            <input type="text" id="player-search" class="search-input"
                placeholder="Buscar por BattleTag (ej: Kuosito)...">
        </div>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th style="width: 50px;">ES</th>
                        <th class="th-eu" style="width: 80px;">EU Rank</th>
                        <th style="text-align: left;">Héroe</th>
                        <th style="text-align: center; width: 60px;">Stats</th>
                        <th style="text-align: right;">MMR</th>
                    </tr>
                </thead>
                <tbody id="leaderboard-body"></tbody>
            </table>
            <div id="loading" class="loading-overlay">
                <div class="spinner"></div>
                El tabernero está acomodando a los jugadores...
            </div>
        </div>

        <footer>
            <div id="last-updated">Actualizado en tiempo real con Blizzard API</div>
            <div style="margin-top: 5px;">Proyecto comunitario de Batalla de Campos España</div>
        </footer>

        <div id="compare-fab" class="compare-fab" onclick="showComparison()">
            <i class="fa-solid fa-bolt"></i>
            <div id="compare-count" class="compare-count">0</div>
        </div>

        <!-- Modals -->
        <div id="history-modal" class="modal">
            <div class="modal-content stats-modal">
                <span class="close-modal" onclick="closeModal('history-modal')">&times;</span>

                <!-- Hero Header -->
                <div class="hero-header">
                    <div class="hero-avatar-container">
                        <img id="modal-player-avatar" src="" class="hero-avatar" alt="">
                        <div id="modal-live-indicator" class="live-indicator-big">LIVE</div>
                    </div>
                    <div class="hero-info">
                        <h2 id="modal-player-name">HÉROE</h2>
                        <div id="modal-player-badges" class="hero-badges"></div>
                    </div>
                </div>

                <!-- Metrics Grid -->
                <div class="metrics-grid">
                    <div class="metric-card">
                        <span class="m-label">MMR ACTUAL</span>
                        <span id="stat-mmr" class="m-value gold">--</span>
                        <div id="delta-24h" class="m-delta"></div>
                    </div>
                    <div class="metric-card">
                        <span class="m-label">RANGO ES</span>
                        <span id="stat-rank-es" class="m-value">#--</span>
                        <div class="m-sub">España</div>
                    </div>
                    <div class="metric-card">
                        <span class="m-label">GLOBAL EU</span>
                        <span id="stat-rank-eu" class="m-value">#--</span>
                        <div class="m-sub">Europa</div>
                    </div>
                    <div class="metric-card">
                        <span class="m-label">PICO MMR</span>
                        <span id="stat-peak" class="m-value">--</span>
                        <div id="delta-7d" class="m-delta"></div>
                    </div>
                </div>

                <!-- Chart Section -->
                <div class="chart-container">
                    <canvas id="historyChart"></canvas>
                </div>

                <!-- Historical Achievements -->
                <div class="historical-section">
                    <h3><i class="fa-solid fa-award"></i> Vitrina de Trofeos</h3>
                    <div id="trophy-case" class="trophy-case">
                        <!-- Trophies will be injected here -->
                    </div>
                </div>
            </div>
        </div>

        <div id="compare-modal" class="modal">
            <div class="modal-content" style="max-width: 900px;">
                <span class="close-modal" onclick="closeModal('compare-modal')">&times;</span>
                <h2 style="font-family: 'Cinzel', serif; color: var(--hs-gold); text-align: center;">Comparativa
                    Tabernera</h2>
                <div id="comparison-target" class="comparison-container"></div>
            </div>
        </div>
    </main>

    <script src="js/utils.js"></script>
    <script src="js/nav.js"></script>
    <script src="app.js"></script>
</body>

</html>